---
title: "Configure customer in Codat"
description: "Create a company and its connection that form the structure required to execute the expense sync process"
sidebar_label: Configure customer
displayed_sidebar: expenses
---

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem"

## Overview

When implementing your Sync for Expenses solution, you need to create your SMB customer as a [company](../terms/company) in Codat before registering their accounting platform as a connection.You can do that when the customer starts interacting with your application.  

Next, you will connect the company to a data source via one of our integrations. With Sync for Expenses, each company will have two data connections: one to the SMB's accounting platform, and another one - to the partner expense integration, i.e. your application.

![A diagram displaying the relationship of a company and two data connections](/img/sync-for-expenses/sfe-connections.png) 

:::tip Authorize your API calls
Remember to [authenticate](/using-the-api/authentication) when making calls to our API. Navigate to **Developers > API keys** in the Portal to pick up your authorization header.
:::

## Create a company

Within Sync for Expenses, a company represents your SMB customer that manages their expenses using your application.
To create it, use our [Create company](/sync-for-expenses-api#/operations/create-company) endpoint. 
This will allow you to synchronize data with that source, fetching or creating bank accounts, suppliers, and customers.

<Tabs>

<TabItem value="nodejs" label="TypeScript">

```javascript
const companyResponse = expensesClient.companies.create({
    name: companyName,
});

if(companyResponse.statusCode == 200){
  throw new Error("Could not create company")
}

const companyId = companyResponse.company.id
console.log(companyId)
```

</TabItem>

<TabItem value="python" label="Python">

```python
company_request = shared.CompanyRequestBody(
    name=company_name,
)

company_response = expenses_client.companies.create(company_request)

if company_response.status_code != 200:
  raise Exception('Could not create company')

company_id = company_response.company.id
print(company_id)
```

</TabItem>

<TabItem value="csharp" label="C#">

```csharp
var companyResponse = await expensesClient.Companies.CreateAsync(new() {
    Name = companyName,
});

if(companyResponse.StatusCode != 200){
  throw new Exception("Could not create company");
}

var companyId = companyResponse.Company.Id;
console.log(companyId)
```

</TabItem>

<TabItem value="go" label="Go">

```go
ctx := context.Background()
companyResponse, err := expensesClient.Companies.Create(ctx, &shared.CompanyRequestBody{
  Name: companyName,
	})

if companyResponse.StatusCode == 200 {
  companyID := companyResponse.Company.ID
  fmt.Println("%s", companyID)
}
```
</TabItem>

<TabItem value="java" label="Java">

```java
CompanyRequestBody companyCreateReq = CompanyRequestBody.builder()
    .name("Bank of Dave")
    .build();

CreateCompanyResponse companyResponse = expensesClient.companies().create()
    .request(companyCreateReq)
    .call();

if (companyResponse.company().isPresent()) {
    companyId = companyResponse.company().get().id;
    System.out.println(companyId);
}
```
</TabItem>

</Tabs>

## Create accounting connection

Next, use the [Create connection](/sync-for-expenses-api#/operations/create-connection) endpoint to connect the company to an accounting data source via one of our integrations. This will allow you to synchronize data with that source. In the request body, specify a `platformKey` of the accounting platform you're looking to connect.

| Accounting platform | platformKey |
| ---  | ---  |
| Oracle NetSuite | `akxx` |
| QuickBooks Online | `qhyg` |
| Sage Intacct | `knfz` |
| Xero | `gbol` |
As an example, let's create a QuickBooks Online (QBO) connection. In response, the endpoint returns a `dataConnection` object with a `PendingAuth` status and a `linkUrl`. Direct your customer to the `linkUrl` to initiate our [Link auth flow](/auth-flow/overview) and enable them to authorize this connection.

<Tabs>

<TabItem value="nodejs" label="TypeScript">

```javascript
const connectionResponse = expensesClient.connections.create({
    requestBody: {
      platformKey: "qhyg",
    },
    companyId: companyResponse.company.id,
  });

console.log(connectionResponse.connection.linkUrl)
```

</TabItem>

<TabItem value="python" label="Python">

```python
connection_request = operations.CreateConnectionRequest(
    request_body=operations.CreateConnectionRequestBody(
        platform_key='qhyg',
    ),
    company_id=company_response.company.id,
)

connection_response = expenses_client.connections.create(connection_request)

console.log(connection_response.connection.link_url)
```

</TabItem>

<TabItem value="csharp" label="C#">

```csharp
var connectionResponse = await expensesClient.Connections.CreateAsync(new() {
    RequestBody = new CreateConnectionRequestBody() {
        PlatformKey = "qhyg",
    },
    CompanyId = companyResponse.Company.Id,
});

Console.WriteLine(connectionResponse.Connection.LinkUrl)
```

</TabItem>

<TabItem value="go" label="Go">

```go
ctx := context.Background()
connectionResponse, err := expensesClient.Connections.Create(ctx, operations.CreateConnectionRequest{
    RequestBody: &operations.CreateConnectionRequestBody{
        PlatformKey: syncforexpenses.String("qhyg"),
    },
    CompanyID: companyResponse.Company.ID,
})

fmt.Println(connectionResponse.Connection.LinkUrl)
```
</TabItem>

<TabItem value="java" label="Java">

```java
CreateConnectionRequest connectionCreateRequest = CreateConnectionRequest.builder()
    .companyId(companyResponse.company().get().id)
    .requestBody(CreateConnectionRequestBody.builder()
        .platformKey("qhyg")
        .build())
    .build();

CreateConnectionResponse connectionResponse = expensesClient.connections().create()
    .request(connectionCreateRequest)
    .call();

if (connectionResponse.connection().isPresent()) {
    System.out.println(connectionResponse.connection.get().linkUrl);
}
```
</TabItem>

</Tabs>

## Create partner expense connection

Once your customer has authorized access to their accounting platform, you need to create another connection for their company for the partner expense integration. 

Use our [Create partner expense connection](/sync-for-expenses-api#/operations/create-partner-expense-connection) to link the company to your application.
This connection is created with the `Linked` status, so you don't need to do anything else to authorize it.

<Tabs>

<TabItem value="nodejs" label="TypeScript">

```javascript
const partnerConnection = await expensesClient.connections.createPartnerExpenseConnection({
    companyId: companyResponse.company.id,
});

if (partnerConnection.statusCode == 200) {
    console.log(partnerConnection.connection.id)
}
```

</TabItem>

<TabItem value="python" label="Python">

```python
partner_connection_req = operations.CreatePartnerExpenseConnectionRequest(
    company_id=company_response.company.id,
)

partner_connection_res = expenses_client.connections.create_partner_expense_connection(partner_connection_req)

console.log(partner_connection_res.connection.id)
```

</TabItem>

<TabItem value="csharp" label="C#">

```csharp
var partnerConnection = await expensesClient.Connections.CreatePartnerExpenseConnectionAsync(new(){
    CompanyId = companyResponse.Company.Id,
});

Console.WriteLine(partnerConnection.Connection.Id)
```

</TabItem>

<TabItem value="go" label="Go">

```go
ctx := context.Background()
partnerConnection, err := s.Connections.CreatePartnerExpenseConnection(ctx,
    operations.CreatePartnerExpenseConnectionRequest{
        CompanyID: companyResponse.Company.ID,
    }
)

fmt.Println(partnerConnection.Connection.ID)
```
</TabItem>

<TabItem value="java" label="Java">

```java
CreatePartnerExpenseConnectionRequest partnerConnectionReq = CreatePartnerExpenseConnectionRequest.builder()
    .companyId(companyResponse.company.get().id)
    .build();

CreatePartnerExpenseConnectionResponse partnerConnectionRes = sdk.connections().createPartnerExpenseConnection()
    .request(partnerConnectionReq)
    .call();

if (partnerConnectionRes.connection().isPresent()) {
    System.out.println(partnerConnectionRes.connection().get().id);
}
```
</TabItem>

</Tabs>

## Deauthorize a connection

If your customer wants to revoke their approval and sever the connection to their accounting package, use the [Unlink connection](/sync-for-expenses-api#/operations/unlink-connection) endpoint.

You can [learn more](/auth-flow/optimize/connection-management) about connection management best practices and see how you can provide this functionality in your app's UI.

<Tabs>

<TabItem value="nodejs" label="TypeScript">

```javascript
const unlinkResponse = expensesClient.connections.unlink({
    requestBody: {
      status: DataConnectionStatus.Unlinked
    },
    companyId: companyResponse.company.id,
    connectionId: connectionResponse.connection.id,
  });
```

</TabItem>

<TabItem value="python" label="Python">

```python
unlink_request = operations.UnlinkConnectionRequest(
    request_body=operations.UnlinkConnectionUpdateConnection(
      status=shared.DataConnectionStatus.UNLINKED
    ),
    company_id=company_response.company.id,
    connection_id=connection_response.connection.id,
)

unlink_response = expenses_client.connections.unlink(unlink_request)

```

</TabItem>

<TabItem value="csharp" label="C#">

```csharp
var unlinkResponse = await expensesClient.Connections.UnlinkAsync(new() {
    RequestBody = new UnlinkConnectionUpdateConnection() {
      Status = DataConnectionStatus.Unlinked
    },
    CompanyId = companyResponse.Company.Id,
    ConnectionId = connectionResponse.Connection.Id,
});
```

</TabItem>

<TabItem value="go" label="Go">

```go
ctx := context.Background()
unlinkResponse, err := expensesClient.Connections.Unlink(ctx, operations.UnlinkConnectionRequest{
    RequestBody: &operations.UnlinkConnectionUpdateConnection{
      Status: shared.DataConnectionStatusUnlinked
    },
    CompanyID: companyResponse.Company.ID,
    ConnectionID: connectionResponse.Connection.ID,
})
```
</TabItem>

<TabItem value="java" label="Java">

```java
UnlinkConnectionRequest unlinkRequest = UnlinkConnectionRequest.builder()
    .companyId(companyResponse.company().get().id)
    .connectionId(connectionResponse.connection().get().id)
    .requestBody(UnlinkConnectionUpdateConnection.builder()
        .status(DataConnectionStatus.UNLINKED)
        .build())
    .build();

UnlinkConnectionResponse unlinkResponse = expensesClient.connections().unlink()
    .request(unlinkRequest)
    .call();
```
</TabItem>

</Tabs>

:::tip Recap

You have created the structure of key objects required by Codat's Sync for Expenses: a company and its connections to an accounting data source and your partner expense integration.

Next, learn how to configure the company to associate the expenses with correct accounts, suppliers, and customers and enable your customers to indicate their preferred expense mapping options. 

:::

---

## Read next

* [Manage your customer's expense configuration](/expenses/config-and-categorize)
